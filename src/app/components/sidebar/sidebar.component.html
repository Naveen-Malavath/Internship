<div class="sidebar" [class.collapsed]="isCollapsed">
  <div class="sidebar-header">
    <button class="new-chat-button" (click)="newChat()" [title]="isCollapsed ? 'New Chat' : ''">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <line x1="12" y1="5" x2="12" y2="19"/>
        <line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
      @if (!isCollapsed) {
        <span>New Chat</span>
      }
    </button>
    
    <button class="toggle-sidebar-button" (click)="toggleSidebar()" title="Toggle Sidebar">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        @if (isCollapsed) {
          <polyline points="9 18 15 12 9 6"/>
        } @else {
          <polyline points="15 18 9 12 15 6"/>
        }
      </svg>
    </button>
  </div>

  <div class="conversations-list">
    @if (conversations().length === 0) {
      <div class="empty-state">
        @if (!isCollapsed) {
          <p>No conversations yet</p>
        }
      </div>
    } @else {
      @for (conversation of conversations(); track conversation.id) {
        <div 
          class="conversation-item"
          [class.active]="currentConversation()?.id === conversation.id"
          (click)="selectConversation(conversation)"
          [title]="isCollapsed ? conversation.title : ''"
        >
          <svg class="conversation-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
          </svg>
          
          @if (!isCollapsed) {
            <div class="conversation-content">
              <span class="conversation-title">{{ conversation.title }}</span>
              <span class="conversation-date">{{ conversation.updatedAt | date:'MMM d' }}</span>
            </div>
            
            <button 
              class="delete-button"
              (click)="deleteConversation($event, conversation.id)"
              title="Delete conversation"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              </svg>
            </button>
          }
        </div>
      }
    }
  </div>

  <div class="sidebar-footer">
    @if (!isCollapsed) {
      <button class="footer-button" (click)="clearAllChats()" title="Clear all chats">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <polyline points="3 6 5 6 21 6"/>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          <line x1="10" y1="11" x2="10" y2="17"/>
          <line x1="14" y1="11" x2="14" y2="17"/>
        </svg>
        <span>Clear all chats</span>
      </button>
    }
    
    <div class="user-profile">
      <div class="user-avatar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
      </div>
      
      @if (!isCollapsed) {
        <div class="user-info">
          <span class="user-name">{{ currentUser()?.name || 'User' }}</span>
          <span class="user-email">{{ currentUser()?.email || '' }}</span>
        </div>
        
        <button class="logout-button" (click)="logout()" title="Logout">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
        </button>
      }
    </div>
  </div>
</div>

