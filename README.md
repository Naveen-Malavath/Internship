# AI Chatbot (Angular + FastAPI + LangChain)

This repository contains a modern **Angular 17** chat frontend paired with a **FastAPI** backend. The UI behaves as “Agent‑1”: it captures customer requirements, sends them to the backend, and renders structured feature plans generated by **Claude 3.5 Haiku** through LangChain. Users can provide thumbs-up/down feedback on each assistant response, allowing you to track satisfaction or trigger follow-up refinements.

## Project Layout

```
Internship/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py              # FastAPI entrypoint + LangChain calls
│   │   ├── schemas.py           # Pydantic models / validators
│   │   └── storage.py           # JSON persistence helpers
│   ├── data/
│   │   └── .gitignore           # Keeps runtime conversations out of git
│   └── requirements.txt         # Backend dependencies (FastAPI + LangChain + Anthropic)
├── frontend/
│   ├── angular.json
│   ├── package.json / package-lock.json
│   ├── tsconfig*.json
│   ├── src/
│   │   ├── app/components/…     # chat-area, login, sidebar, message-bubble
│   │   ├── app/services/…       # auth.service, chat.service
│   │   ├── app/config/api.config.ts
│   │   └── app/guards/auth.guard.ts
│   └── *.md                     # Reference guides and setup docs
└── README.md (this file)
```

## Key Features

### Frontend
- Angular 17 using standalone components and Signals
- Customer prompt capture, loading indicator, and structured responses
- Thumbs-up / thumbs-down feedback controls for assistant replies
- Console debug statements to trace Agent‑1 activity end to end
- Responsive layout with polished styling and onboarding suggestions

### Backend
- FastAPI with permissive CORS for the Angular dev server
- LangChain integration with **Claude 3.5 Haiku** (Anthropic) to generate feature lists
- REST endpoints for login, conversations, message generation, and feedback
- JSON file persistence stored in `backend/data/`
- Extensive logging so you can monitor prompt flow, Claude invocations, and feedback

## Prerequisites

- **Node.js** 18+
- **Python** 3.10+
- An Anthropic API key with access to Claude Haiku 3.5 (set as `ANTHROPIC_API_KEY`)

## Quick Start

### 1. Install Frontend Dependencies
```bash
cd Internship/frontend
npm install
```

### 2. Create a Python Virtual Environment & Install Backend Dependencies
```bash
cd ../backend
python -m venv venv
source venv/bin/activate       # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 3. Configure the Anthropic API Key
```bash
export ANTHROPIC_API_KEY="sk-ant-..."
# or on Windows PowerShell
# $env:ANTHROPIC_API_KEY="sk-ant-..."
```
The backend reads this environment variable on startup. Optionally, set `ANTHROPIC_MODEL` to override the default (`claude-3-5-haiku-20241022`).

### 4. Start the FastAPI Backend
```bash
uvicorn app.main:app --reload --port 8000
```
Backend runs at `http://localhost:8000` with API routes under `/api/*` and logs Agent‑1 debug information to the console.

### 5. Start the Angular Frontend
```bash
cd ../frontend
npm start
```
The frontend runs at `http://localhost:4200` and communicates with the backend via the base URL defined in `src/app/config/api.config.ts`.

## API Endpoints

| Method | Endpoint                                                                  | Description                                                              |
|--------|---------------------------------------------------------------------------|--------------------------------------------------------------------------|
| GET    | `/api/health`                                                             | Health check                                                             |
| POST   | `/api/auth/login`                                                         | Email/password login (mock – simply echoes the email back)               |
| GET    | `/api/conversations`                                                      | List all conversations                                                   |
| POST   | `/api/conversations`                                                      | Create a new conversation                                                |
| GET    | `/api/conversations/{conversationId}`                                     | Retrieve a conversation and its messages                                 |
| POST   | `/api/conversations/{conversationId}/messages`                            | Add a user prompt; backend stores it, calls Claude via LangChain, and returns the updated conversation |
| POST   | `/api/conversations/{conversationId}/messages/{messageId}/feedback`       | Record thumbs-up/down feedback on an assistant response                  |
| DELETE | `/api/conversations/{conversationId}`                                     | Delete a single conversation                                             |
| DELETE | `/api/conversations`                                                      | Delete all conversations and create a fresh default chat                 |

## Frontend Integration Highlights

- `AuthService` calls `POST /api/auth/login`, persists the returned user via Signals/localStorage, and navigates to the chat view.
- `ChatService` orchestrates all chat API calls (list/create/send/delete/feedback) and logs diagnostic messages (`console.debug`) so you can trace state transitions.
- `MessageBubbleComponent` renders the assistant reply along with thumbs-up/down controls that post feedback to the backend.
- `chat-area` emits feedback events and automatically scrolls to the latest messages.

## Backend Implementation Notes

- `backend/app/main.py` loads the Anthropic API key from the environment, builds a LangChain `ChatPromptTemplate`, and invokes `ChatAnthropic` to produce structured feature plans.
- If the key is missing or the model call fails, the service falls back to a helpful placeholder explaining the issue.
- Feedback is persisted in the JSON store via `ConversationStorage.update_message_feedback`, allowing you to analyse satisfaction later.

## Development Tips

- Update `API_BASE_URL` if you expose the backend on a different host/port.
- Runtime conversation data lives in `backend/data/conversations.json` (ignored by git). Delete the file to reset state.
- Frontend reference docs (`frontend/SETUP_GUIDE.md`, `frontend/FEATURES.md`, etc.) remain available in the `frontend` folder.
- Consider Docker or process managers if you deploy both services together.

## Useful Scripts

| Command                                 | Description                             |
|-----------------------------------------|-----------------------------------------|
| `npm start` (run inside `frontend/`)    | Start Angular dev server                 |
| `npm run build` (inside `frontend/`)    | Build production bundle                  |
| `uvicorn app.main:app --reload`         | Start FastAPI with auto-reload           |
| `pip install -r backend/requirements.txt` | Install backend dependencies             |

## License

This codebase is supplied for educational and prototyping purposes. Add proper authentication, authorization, telemetry, and secure AI provider calls before using it in production.
