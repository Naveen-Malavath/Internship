graph TD
    %% User Touchpoints
    Customer["Customer"]
    Merchant["Merchant/Vendor"]
    Developer["Third-Party Developer"]
    Admin["Platform Admin"]

    %% Frontend Layer
    WebStorefront["Web Storefront"]
    MobileStorefront["Mobile Storefront"]
    IoTStorefront["IoT Storefront"]
    VendorPortal["Vendor Portal"]
    AdminDashboard["Admin Dashboard"]

    %% API Gateway Layer
    APIGateway["Headless API Gateway<br/>(GraphQL/REST)<br/>Auth | Rate Limiting | Routing"]

    %% Core Commerce Services
    ProductCatalog["Product Catalog Service<br/>Millions of SKUs<br/>Elastic Search <100ms<br/>Multi-language/Currency"]
    InventoryEngine["Inventory Orchestration<br/>Real-time Aggregation<br/>Distributed Locking<br/>Smart Allocation"]
    OrderManagement["Order Management System<br/>Multi-Channel Orders<br/>Fulfillment Workflows<br/>Returns & Exchanges"]
    CheckoutPayment["Checkout & Payment<br/>Payment Orchestration<br/>Fraud Detection<br/>Tax & Shipping"]
    LoyaltyEngine["Loyalty & Rewards<br/>Points & Tiers<br/>Referrals<br/>Personalized Rewards"]

    %% AI & Personalization Layer
    AIPersonalization["AI Personalization Engine<br/>ML Models<br/>Behavior Analysis<br/>Dynamic Pricing<br/>Recommendations"]

    %% Content & Digital Assets
    HeadlessCMS["Headless CMS<br/>Content Management<br/>Digital Assets<br/>CDN Integration<br/>Version Control"]

    %% Integration & Extensibility
    IntegrationHub["API Marketplace<br/>Integration Hub<br/>SDK Libraries<br/>Webhook Management<br/>Sandbox Environment"]

    %% Vendor Management
    VendorManagement["Vendor Management<br/>Onboarding Workflows<br/>Commission Engine<br/>Automated Payouts"]

    %% Analytics & Monitoring
    AnalyticsHub["Analytics & Reporting<br/>Real-time Dashboards<br/>Data Warehouse<br/>BI Layer<br/>Custom Reports"]
    MonitoringSuite["Performance Monitoring<br/>Distributed Tracing<br/>API Metrics<br/>Automated Alerts<br/>CI/CD Integration"]

    %% Data Layer
    ProductDB[("Product Database<br/>Flexible Schema")]
    InventoryDB[("Inventory Database<br/>Multi-location")]
    OrderDB[("Order Database<br/>Transaction Log")]
    CustomerDB[("Customer Database<br/>Profile & History")]
    AnalyticsDB[("Analytics Warehouse<br/>Aggregated Data")]
    ContentDB[("Content Database<br/>Assets & Metadata")]

    %% External Services
    PaymentProviders["Payment Providers<br/>Multiple Gateways<br/>Digital Wallets<br/>BNPL"]
    FulfillmentCenters["Fulfillment Centers<br/>Warehouses<br/>3PL Partners<br/>Stores"]
    CDN["CDN Network<br/>Global Distribution<br/>Image Optimization"]
    MLPlatform["ML Platform<br/>Training Pipeline<br/>Model Serving"]

    %% User Flows
    Customer --> WebStorefront
    Customer --> MobileStorefront
    Customer --> IoTStorefront
    Merchant --> VendorPortal
    Developer --> IntegrationHub
    Admin --> AdminDashboard

    %% Frontend to Gateway
    WebStorefront --> APIGateway
    MobileStorefront --> APIGateway
    IoTStorefront --> APIGateway
    VendorPortal --> APIGateway
    AdminDashboard --> APIGateway

    %% Gateway to Services
    APIGateway --> ProductCatalog
    APIGateway --> InventoryEngine
    APIGateway --> OrderManagement
    APIGateway --> CheckoutPayment
    APIGateway --> LoyaltyEngine
    APIGateway --> HeadlessCMS
    APIGateway --> VendorManagement
    APIGateway --> AIPersonalization

    %% Service Interactions
    ProductCatalog --> ProductDB
    ProductCatalog --> HeadlessCMS
    
    InventoryEngine --> InventoryDB
    InventoryEngine --> FulfillmentCenters
    
    OrderManagement --> OrderDB
    OrderManagement --> InventoryEngine
    OrderManagement --> FulfillmentCenters
    OrderManagement --> LoyaltyEngine
    
    CheckoutPayment --> PaymentProviders
    CheckoutPayment --> OrderManagement
    
    AIPersonalization --> CustomerDB
    AIPersonalization --> MLPlatform
    AIPersonalization --> ProductCatalog
    
    HeadlessCMS --> ContentDB
    HeadlessCMS --> CDN
    
    VendorManagement --> ProductCatalog
    VendorManagement --> InventoryEngine
    VendorManagement --> OrderManagement
    
    LoyaltyEngine --> CustomerDB
    LoyaltyEngine --> OrderDB

    %% Analytics & Monitoring
    ProductCatalog -.->|Metrics| AnalyticsHub
    InventoryEngine -.->|Metrics| AnalyticsHub
    OrderManagement -.->|Metrics| AnalyticsHub
    CheckoutPayment -.->|Metrics| AnalyticsHub
    LoyaltyEngine -.->|Metrics| AnalyticsHub
    
    AnalyticsHub --> AnalyticsDB
    
    APIGateway -.->|Traces| MonitoringSuite
    ProductCatalog -.->|Traces| MonitoringSuite
    InventoryEngine -.->|Traces| MonitoringSuite
    OrderManagement -.->|Traces| MonitoringSuite
    CheckoutPayment -.->|Traces| MonitoringSuite

    %% Integration Hub Connections
    IntegrationHub -.->|Webhooks| OrderManagement
    IntegrationHub -.->|Webhooks| InventoryEngine
    IntegrationHub -.->|SDK| APIGateway

    %% Business Flow Annotations
    subgraph "Customer Journey"
        WebStorefront
        MobileStorefront
        IoTStorefront
    end

    subgraph "Commerce Core"
        ProductCatalog
        InventoryEngine
        OrderManagement
        CheckoutPayment
    end

    subgraph "Intelligence Layer"
        AIPersonalization
        LoyaltyEngine
        AnalyticsHub
    end

    subgraph "Extensibility Platform"
        IntegrationHub
        VendorManagement
    end

    subgraph "Observability"
        MonitoringSuite
        AnalyticsHub
    end

    %% Style Definitions